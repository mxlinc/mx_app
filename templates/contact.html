<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Contact Us - MX Learning</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root{ --maroon:#5a0f1f; --navy:#0f2b59; --bg:#f7f8fb; --text:#122033 }
        body { font-family: 'Poppins', sans-serif; background: var(--bg); margin:0; color:var(--text); -webkit-font-smoothing:antialiased; font-size:16px }
        .container { max-width:820px; margin:28px auto; padding:18px }
        .card { background:#fff; border-radius:14px; box-shadow:0 8px 26px rgba(16,32,56,0.08); padding:26px }
        h2 { color:var(--maroon); margin-top:0; font-size:22px; letter-spacing:-0.2px }
        .muted { color:var(--navy); font-size:15px; margin-top:6px }
        .row { display:flex; gap:12px; margin-bottom:14px }
        .col { flex:1 }
        label { display:block; font-weight:600; margin-bottom:8px; color:var(--navy); font-size:15px }
        .small-input { width:100%; padding:12px 14px; border:1px solid #e2e7f0; border-radius:10px; box-sizing:border-box; font-size:16px }
        input[type="text"], textarea, select { width:100%; padding:12px 14px; border:1px solid #e2e7f0; border-radius:10px; font-size:16px }
        textarea { min-height:140px; resize:vertical }
        .btn { background:var(--navy); color:white; border:none; padding:12px 18px; border-radius:10px; cursor:pointer; font-weight:700; font-size:16px }
        .btn:disabled { opacity:0.6; cursor:default }
        .message { margin-top:12px; font-size:15px; color:var(--navy) }
        .small { font-size:13px; color:#6b7280 }
        .footer { font-size:13px; color:var(--navy); opacity:0.85 }
        @media (max-width:760px){
            body { font-size:20px }
            .container { padding:18px; margin:14px auto }
            .card { padding:20px }
            .row { flex-direction:column; gap:14px }
            label { font-size:18px }
            input[type="text"], .small-input, select { font-size:18px; padding:14px 16px }
            textarea { min-height:180px; font-size:18px; padding:14px 16px }
            .btn { width:100%; padding:14px 16px; font-size:18px }
        }
    </style>
</head>
<body>
    <div class="container">
            <div class="card">
                <h2>Contact Us</h2>
                <p class="muted">Please fill this form and we will give you some scheduling options for a free assessment/orientation session with us.</p>

            <form id="contactForm">
                <div class="row">
                    <div class="col">
                        <label for="your_name">Your Name</label>
                        <input id="your_name" name="your_name" type="text" class="small-input">
                    </div>
                </div>

                <div class="row">
                    <div class="col">
                        <label for="phone">Phone</label>
                        <input id="phone" name="phone" type="text" class="small-input" placeholder="e.g. 416-555-1212">
                    </div>
                    <div class="col">
                        <label for="email">Email</label>
                        <input id="email" name="email" type="text" class="small-input" placeholder="name@example.com">
                    </div>
                </div>

                <div class="row">
                    <div class="col">
                        <label for="child_name">Child's Name & Age</label>
                        <input id="child_name" name="child_name" type="text" class="small-input">
                    </div>
                </div>

                <div class="row">
                    <div class="col">
                        <label for="grade">Grade</label>
                        <select id="grade" name="grade">
                            <option>Preschool / Casa / Kindergarten</option>
                            <option>Grade 1 to 3</option>
                            <option>Grade 4 to 8</option>
                            <option>High school</option>
                        </select>
                    </div>
                </div>

                <!-- Subject removed per design -->

                <div class="row">
                    <div class="col">
                        <label for="about">Tell us about your child</label>
                        <textarea id="about" name="about"></textarea>
                    </div>
                </div>

                <div style="display:flex; align-items:center; gap:12px">
                    <button id="submitBtn" class="btn" type="submit">Send</button>
                    <div id="status" class="message"></div>
                </div>
                <div style="height:6px"></div>
                <div class="small"></div>
                <div class="footer" style="text-align:center;margin-top:14px">Â© Montessori Experience Inc.</div>
            </form>
        </div>
    </div>

    <script>
        const form = document.getElementById('contactForm');
        const btn = document.getElementById('submitBtn');
        const status = document.getElementById('status');

        function cooldownActive(){
            const t = sessionStorage.getItem('contact_cooldown');
            if(!t) return false;
            return Date.now() < parseInt(t,10);
        }

        form.addEventListener('submit', async (e)=>{
            e.preventDefault();
            if(cooldownActive()){
                status.textContent = 'Please wait before sending another request.';
                return;
            }
            btn.disabled = true;
            status.textContent = 'Sending...';

            const payload = {
                your_name: document.getElementById('your_name').value,
                phone: document.getElementById('phone').value,
                email: document.getElementById('email') ? document.getElementById('email').value : '',
                child_name: document.getElementById('child_name').value,
                grade: document.getElementById('grade').value,
                about: document.getElementById('about').value
            };

            try{
                const resp = await fetch('/contact_submit', {
                    method: 'POST', headers: {'Content-Type':'application/json'},
                    body: JSON.stringify(payload)
                });
                const j = await resp.json();
                // show a professional confirmation and remove the form
                const heading = document.querySelector('.card h2');
                if (heading) heading.style.display = 'none';
                const muted = document.querySelector('.card .muted');
                if (muted) muted.style.display = 'none';

                const confirmation = document.createElement('div');
                confirmation.style.fontFamily = "'Poppins', sans-serif";
                confirmation.style.fontSize = '16px';
                confirmation.style.color = '#1b3a6f';
                confirmation.style.padding = '18px';
                confirmation.innerHTML = '<h3>Your message has been received.</h3><p style="color:#333;font-size:15px;">One of our certified teachers will contact you within the next 24 hours.</p>';

                // add Close button below the message that returns to homepage
                const closeBtn = document.createElement('button');
                closeBtn.className = 'btn';
                closeBtn.textContent = 'Close';
                closeBtn.style.marginTop = '14px';
                closeBtn.addEventListener('click', ()=>{ window.location.href = 'https://mxlearning.com/'; });
                confirmation.appendChild(closeBtn);

                form.parentNode.replaceChild(confirmation, form);
                // set short client cooldown to reduce accidental resends
                const cooldownMs = 60*1000; // 60s
                sessionStorage.setItem('contact_cooldown', String(Date.now() + cooldownMs));
            }catch(err){
                console.error(err);
                status.textContent = 'Error sending. Please try again later.';
            }finally{
                btn.disabled = false;
            }
        });
    </script>
</body>
</html>
